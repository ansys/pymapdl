Migrated PR #3868